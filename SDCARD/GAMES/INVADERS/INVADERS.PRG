 ;** START ** def_start() mode 1:cursor 1:cls _init() repeat  _aboutscreen()  _initgame()  repeat   _initlevel()   _gameloop()   if aliens==0    _nextwave()   else    _loselife()   endif  until lives==0  _gameover() until 0 enddef ;** UPDATE SCORE ** def_updateScore(amount) score=score+amount if score>hiScore:hiScore=score:endif _status() enddef ;** STATUS LINE ** def_status() printat 7,0,score printat 18,0,lives printat 28,0,hiScore enddef ;** HEADER LINE ** def_header() plot 0,0,"SCORE:" plot 12,0,"LIVES:" plot 25,0,"HI:" enddef ;** MOVE BOLT ** def_movebolt() if boltY<>0  boltY=boltY-1  if scrn(boltX,boltY)==alienC   for a=1,level,1    _checkHit(a)   next  else   if boltY<>0:plot boltX,boltY,boltC:sound 1,(30-boltY)*10,10:endif   plot boltX,boltY+1,32  endif else  sound 1,0,0 endif enddef ;** CHECK ALIEN HIT ** def_checkHit(idx) if (alienX[idx]==boltX) & (alienY[idx]==boltY) & (boltY<>0)  plot boltX,boltY,32:plot boltX,boltY+1,32  alienY[idx]=0:boltY=0  aliens=aliens-1  play 1,2,3,3000  _updateScore(level) endif enddef ;** MOVE ALIEN ** def_movealien(a)  if alienY[a]<>0   oldX=alienX[a]:oldY=alienY[a]   alienY[a]=alienY[a]+1   _checkHit(a)   plot oldX,oldY,32:if alienY[a]<>0:plot alienX[a],alienY[a],alienC:endif   if alienY[a]>=shipY:dead=1:endif  endif enddef ;** MOVE NEXT ALIEN ** def_movenextalien() repeat  alienIdx=(alienIdx\level)+1 until alienY[alienIdx]<>0 _movealien(alienIdx) enddef ;** MOVE SHIP ** def_moveship() j=stick(0xff) oldX=shipX:oldY=shipY if (j & 0x40) & (shipX>0)   shipX=shipX-1 endif if (j & 0x20) & (shipX<29)   shipX=shipX+1 endif if shipX<>oldX  _drawship()  if shipX>oldX   plot oldX,shipY,32  else   plot oldX+2,shipY,32  endif endif if (j & 0x80) & (boltY==0)  boltX=shipX+1:boltY=shipY-1  plot boltX,boltY,boltC endif enddef ;** DRAW SHIP ** def_drawship() plot shipX,shipY,shipC:plot shipX+1,shipY,shipC+8:plot shipX+2,shipY,shipC+16 enddef ;** INITIALISE GAME ** def_initgame() lives=3:level=1 alienSpeed=30 score=0 alienAcc=5 level=1 enddef ;** INITIALISE LEVEL ** def_initlevel() cls:_header():_status() shipX=16:shipY=23 _drawship()  printat 12,11,"LEVEL ",level for a=1,level,1  alienY[a]=rnd(0)\level+1  alienX[a]=a*3+(14-((3*level)/2))  alienS[a]=1  plot alienX[a],alienY[a],alienC  wait 20 next wait 30 plot 12,11,"       " boltY=0 shipSpeed=3 boltSpeed=2 aliens=level alienIdx=0 play 1,0,0,0 sound 1,0,0 sound 2,15,0 enddef ;** MAIN GAME LOOP CONTROL ** def_gameloop() counter=0 dead = 0 _header() _status() repeat  counter=counter+1  if (counter\shipSpeed)==0:_moveship():endif  if (counter\alienSpeed)==0:_movenextalien():endif  if (counter\boltSpeed)==0:_movebolt():endif  wait 1 until (dead==1) | (aliens==0) enddef ;** WAVE COMPLETED ** def_nextwave() sound 1,0,0 plot 10,11,"WAVE CLEARED" level=level+1 if level>9  level=9  if alienSpeed>alienAcc   alienSpeed=alienSpeed-alienAcc  else   alienSpeed=1  endif endif wait 90 enddef ;** LOSE A LIFE ** def_loselife() lives=lives-1 _status() sound 1,0,0 wait 90 enddef ;** GAME OVER ** def_gameover() plot 11,11,"GAME OVER" wait 90 enddef ;** START SCREEN ** def_aboutscreen() cls for c=0,15,1  colour c,2,1 next println " ******************************" println " *      SPACE INVADERS!       *" println " *       By Dolo Miah         *" println " ******************************" println println " Back story:" println "  You are Earth's last defence" println "  against the alien hordes!" println "  At first, they came a few at" println "  a time. But each time they" println "  appear defeated, they return" println "  in even greater numbers!" println "  Many valiant pilots have" println "  tried and failed." println "  How long can you hold out?!" println " Your objective:" println "  Destroy all aliens before" println "  they descend to Earth. You" println "  have 3 lives but each wave" println "  completed results in another" println "  wave with more aliens!" println "  Use the joystick to move and" println "  shoot. GOOD LUCK!!" print   " PRESS JOYSTICK BUTTON TO START" repeat:until stick(128)<>0 enddef ;** DATA DEFINITIONS ** def_init() shipC=16*8:boltC=19*8:alienC=20*8 repeat  read c  if c<>0   for i=0,7,1    read d    vpoke c*8+i,d   next  endif until c==0 dim alienX[10],alienY[20],alienS[10] colour 19,11,1 colour 16,6,1:colour 17,4,1:colour 18,6,1 colour 20,6,1 setvdp 7,0x51 enddef data boltC data 0b00001100 data 0b00011000 data 0b00110000 data 0b00011000 data 0b00001100 data 0b00011000 data 0b00110000 data 0b00011000 data shipC data 0b00000000 data 0b00000100 data 0b00000100 data 0b00001110 data 0b00001110 data 0b00001111 data 0b00000111 data 0b00000000 data shipC+8 data 0b00011000 data 0b00011000 data 0b00111100 data 0b00111100 data 0b01111110 data 0b11111111 data 0b11111111 data 0b01111110 data shipC+8+8 data 0b00000000 data 0b00100000 data 0b00100000 data 0b01110000 data 0b01110000 data 0b11110000 data 0b11100000 data 0b00000000 data alienC data 0b01000010 data 0b00100100 data 0b00111100 data 0b01011010 data 0b11111111 data 0b11111111 data 0b01000010 data 0b00100100 data 0 ; end